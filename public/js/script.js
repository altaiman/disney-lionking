'use strict';

(function (root) {

  // svg for all
  svg4everybody();
  scrollTo();

  function scrollTo() {
    var links = document.querySelectorAll('a[href*="#"]');
    links.forEach(function (each) {
      return each.onclick = scrollAnchors;
    });
  }

  function scrollAnchors(e) {
    var respond = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;

    var distanceToTop = function distanceToTop(el) {
      return Math.floor(el.getBoundingClientRect().top);
    };

    e.preventDefault();

    var targetID = respond ? respond.getAttribute('href') : this.getAttribute('href');

    var targetAnchor = document.querySelector(targetID);

    if (!targetAnchor) return;

    var originalTop = distanceToTop(targetAnchor);

    window.scrollBy({ top: originalTop, left: 0, behavior: 'smooth' });

    var checkIfDone = setInterval(function () {
      var atBottom = window.innerHeight + window.pageYOffset >= document.body.offsetHeight - 2;
      if (distanceToTop(targetAnchor) === 0 || atBottom) {
        targetAnchor.tabIndex = '-1';
        targetAnchor.focus();
        window.history.pushState('', '', targetID);
        clearInterval(checkIfDone);
      }
    }, 100);

    document.querySelector('.menu').classList.remove('menu_open');
  }

  var translate = function translate(elem, x, y, rotate) {
    $(elem).css({
      'transform': 'translate3d(' + x + 'px,' + y + 'px, 0px) rotate(' + -rotate + 'deg)',
      '-webkit-backface-visibility': 'hidden',
      '-webkit-perspective': 1000,
      'will-change': 'transform'
    });
  };

  // parallax
  $(window).on('scroll', function () {
    var top = $(document).scrollTop();

    translate("#decor-el1", 0, top / 10, top / 30);
    translate("#decor-el2", 0, -top / 10, 0);
    translate("#decor-el3", 0, -top / 40, top / 30);
    translate("#decor-el4", 0, top / 100, 0);
    translate("#decor-el5", 0, -top / 20, -top / 10);
    translate("#decor-el6", 0, 0, -top / 20);
    translate("#decor-el7", 0, top / 60, 0);
    translate("#decor-el8", 0, 0, -top / 20);
    translate("#decor-el9", -top / 40, -top / 40, 0);
    translate("#decor-el10", 0, -top / 100, -top / 10);
  });

  var sliderOptions = {
    'prizes': {
      cellAlign: 'center',
      prevNextButtons: false,
      groupCells: $(window).width() <= 768 ? 1 : 2,
      wrapAround: true,
      contain: true
    },
    'production': {
      cellAlign: 'center',
      prevNextButtons: false,
      groupCells: $(window).width() <= 1000 ? $(window).width() <= 768 ? 1 : 2 : 4,
      wrapAround: true,
      contain: true
    }
  };

  document.querySelectorAll('[data-slider]').forEach(function (slider, i) {
    var slides = slider.querySelector('[data-slider-slides]'),
        slidesCount = slides.children.length,
        sliderData = slider.dataset.slider,
        options = sliderOptions[sliderData],
        sliderWidth = slider.offsetWidth,
        slideWidth = slides.children[0].offsetWidth,
        slidesCapacity = Math.round(sliderWidth / slideWidth),
        controls = slider.querySelector('[data-slider-controls]'),
        controlsEndIndex = slidesCount - slidesCapacity,
        adaptive = Number(slider.dataset.sliderAdaptive),
        windowWidth = window.innerWidth;

    var controlsPrev = void 0,
        controlsNext = void 0;

    if (controls) {
      controlsPrev = controls.querySelector('[data-slider-controls-prev]'), controlsNext = controls.querySelector('[data-slider-controls-next]');
    }

    if (slidesCount > slidesCapacity) {
      slider.classList.add('slider_initial');
      var flkty = new Flickity(slides, sliderOptions[slider.dataset.slider]);

      if (controls) {
        controlsPrev.addEventListener('click', function (e) {
          e.preventDefault();
          flkty.previous();
        });

        controlsNext.addEventListener('click', function (e) {
          e.preventDefault();
          flkty.next();
        });

        if (!options.wrapAround) {
          if (flkty.selectedIndex === 0) {
            controlsPrev.disabled = true;
          } else if (flkty.selectedIndex === controlsEndIndex) {
            controlsNext.disabled = true;
          }
        }
      }
    }
  });

  $('.question__header').on('click', function (e) {
    e.preventDefault();

    $(this).next().slideToggle();
    $(this).parent().toggleClass('open');
  });

  $('.navigator__menu').on('click', function (e) {
    e.preventDefault();
    $('.menu').toggle();
  });

  $('.menu__close').on('click', function (e) {
    $('.menu').hide();
  });

  $('.menu__link').on('click', function () {
    $('.menu__close').click();
  });

  // modals

  $('[data-modal]').iziModal();

  $('[data-modal-open]').on('click', function (e) {
    e.preventDefault();

    var data = $(this).data('modal-open');
    $('[data-modal="' + data + '"]').iziModal('open');
  });
})(window);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNjcmlwdC5qcyJdLCJuYW1lcyI6WyJyb290Iiwic3ZnNGV2ZXJ5Ym9keSIsInNjcm9sbFRvIiwibGlua3MiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJmb3JFYWNoIiwiZWFjaCIsIm9uY2xpY2siLCJzY3JvbGxBbmNob3JzIiwiZSIsInJlc3BvbmQiLCJkaXN0YW5jZVRvVG9wIiwiTWF0aCIsImZsb29yIiwiZWwiLCJnZXRCb3VuZGluZ0NsaWVudFJlY3QiLCJ0b3AiLCJwcmV2ZW50RGVmYXVsdCIsInRhcmdldElEIiwiZ2V0QXR0cmlidXRlIiwidGFyZ2V0QW5jaG9yIiwicXVlcnlTZWxlY3RvciIsIm9yaWdpbmFsVG9wIiwid2luZG93Iiwic2Nyb2xsQnkiLCJsZWZ0IiwiYmVoYXZpb3IiLCJjaGVja0lmRG9uZSIsInNldEludGVydmFsIiwiYXRCb3R0b20iLCJpbm5lckhlaWdodCIsInBhZ2VZT2Zmc2V0IiwiYm9keSIsIm9mZnNldEhlaWdodCIsInRhYkluZGV4IiwiZm9jdXMiLCJoaXN0b3J5IiwicHVzaFN0YXRlIiwiY2xlYXJJbnRlcnZhbCIsImNsYXNzTGlzdCIsInJlbW92ZSIsInRyYW5zbGF0ZSIsImVsZW0iLCJ4IiwieSIsInJvdGF0ZSIsIiQiLCJjc3MiLCJvbiIsInNjcm9sbFRvcCIsInNsaWRlck9wdGlvbnMiLCJjZWxsQWxpZ24iLCJwcmV2TmV4dEJ1dHRvbnMiLCJncm91cENlbGxzIiwid2lkdGgiLCJ3cmFwQXJvdW5kIiwiY29udGFpbiIsInNsaWRlciIsImkiLCJzbGlkZXMiLCJzbGlkZXNDb3VudCIsImNoaWxkcmVuIiwibGVuZ3RoIiwic2xpZGVyRGF0YSIsImRhdGFzZXQiLCJvcHRpb25zIiwic2xpZGVyV2lkdGgiLCJvZmZzZXRXaWR0aCIsInNsaWRlV2lkdGgiLCJzbGlkZXNDYXBhY2l0eSIsInJvdW5kIiwiY29udHJvbHMiLCJjb250cm9sc0VuZEluZGV4IiwiYWRhcHRpdmUiLCJOdW1iZXIiLCJzbGlkZXJBZGFwdGl2ZSIsIndpbmRvd1dpZHRoIiwiaW5uZXJXaWR0aCIsImNvbnRyb2xzUHJldiIsImNvbnRyb2xzTmV4dCIsImFkZCIsImZsa3R5IiwiRmxpY2tpdHkiLCJhZGRFdmVudExpc3RlbmVyIiwicHJldmlvdXMiLCJuZXh0Iiwic2VsZWN0ZWRJbmRleCIsImRpc2FibGVkIiwic2xpZGVUb2dnbGUiLCJwYXJlbnQiLCJ0b2dnbGVDbGFzcyIsInRvZ2dsZSIsImhpZGUiLCJjbGljayIsIml6aU1vZGFsIiwiZGF0YSJdLCJtYXBwaW5ncyI6Ijs7QUFBQSxDQUFDLFVBQVNBLElBQVQsRUFBZTs7QUFFZDtBQUNBQztBQUNBQzs7QUFFQSxXQUFTQSxRQUFULEdBQW9CO0FBQ25CLFFBQU1DLFFBQVFDLFNBQVNDLGdCQUFULENBQTBCLGNBQTFCLENBQWQ7QUFDQUYsVUFBTUcsT0FBTixDQUFjO0FBQUEsYUFBU0MsS0FBS0MsT0FBTCxHQUFlQyxhQUF4QjtBQUFBLEtBQWQ7QUFDQTs7QUFFRCxXQUFTQSxhQUFULENBQXVCQyxDQUF2QixFQUEwQztBQUFBLFFBQWhCQyxPQUFnQix1RUFBTixJQUFNOztBQUN6QyxRQUFNQyxnQkFBZ0IsU0FBaEJBLGFBQWdCO0FBQUEsYUFBTUMsS0FBS0MsS0FBTCxDQUFXQyxHQUFHQyxxQkFBSCxHQUEyQkMsR0FBdEMsQ0FBTjtBQUFBLEtBQXRCOztBQUVBUCxNQUFFUSxjQUFGOztBQUVBLFFBQUlDLFdBQVlSLE9BQUQsR0FBWUEsUUFBUVMsWUFBUixDQUFxQixNQUFyQixDQUFaLEdBQTJDLEtBQUtBLFlBQUwsQ0FBa0IsTUFBbEIsQ0FBMUQ7O0FBRUEsUUFBTUMsZUFBZWpCLFNBQVNrQixhQUFULENBQXVCSCxRQUF2QixDQUFyQjs7QUFFQyxRQUFJLENBQUNFLFlBQUwsRUFBbUI7O0FBRXBCLFFBQU1FLGNBQWNYLGNBQWNTLFlBQWQsQ0FBcEI7O0FBRUFHLFdBQU9DLFFBQVAsQ0FBZ0IsRUFBRVIsS0FBS00sV0FBUCxFQUFvQkcsTUFBTSxDQUExQixFQUE2QkMsVUFBVSxRQUF2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LE9BQXJCLEVBQThCLFVBQVN2QyxDQUFULEVBQVk7QUFDeENxQyxNQUFFLE9BQUYsRUFBVzhDLElBQVg7QUFDRCxHQUZEOztBQUlBOUMsSUFBRSxhQUFGLEVBQWlCRSxFQUFqQixDQUFvQixPQUFwQixFQUE2QixZQUFXO0FBQ3RDRixNQUFFLGNBQUYsRUFBa0IrQyxLQUFsQjtBQUNELEdBRkQ7O0FBSUE7O0FBRUEvQyxJQUFFLGNBQUYsRUFBa0JnRCxRQUFsQjs7QUFFQWhELElBQUUsbUJBQUYsRUFBdUJFLEVBQXZCLENBQTBCLE9BQTFCLEVBQW1DLFVBQVN2QyxDQUFULEVBQVk7QUFDN0NBLE1BQUVRLGNBQUY7O0FBR0EsUUFBTThFLE9BQU9qRCxFQUFFLElBQUYsRUFBUWlELElBQVIsQ0FBYSxZQUFiLENBQWI7QUFDQWpELHdCQUFrQmlELElBQWxCLFNBQTRCRCxRQUE1QixDQUFxQyxNQUFyQztBQUNELEdBTkQ7QUFRRCxDQWxLRCxFQWtLR3ZFLE1BbEtIIiwiZmlsZSI6InNjcmlwdC5qcyIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbihyb290KSB7XG5cbiAgLy8gc3ZnIGZvciBhbGxcbiAgc3ZnNGV2ZXJ5Ym9keSgpXG4gIHNjcm9sbFRvKClcblxuICBmdW5jdGlvbiBzY3JvbGxUbygpIHtcbiAgXHRjb25zdCBsaW5rcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ2FbaHJlZio9XCIjXCJdJylcbiAgXHRsaW5rcy5mb3JFYWNoKGVhY2ggPT4gKGVhY2gub25jbGljayA9IHNjcm9sbEFuY2hvcnMpKVxuICB9XG5cbiAgZnVuY3Rpb24gc2Nyb2xsQW5jaG9ycyhlLCByZXNwb25kID0gbnVsbCkge1xuICBcdGNvbnN0IGRpc3RhbmNlVG9Ub3AgPSBlbCA9PiBNYXRoLmZsb29yKGVsLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLnRvcClcblxuICBcdGUucHJldmVudERlZmF1bHQoKVxuXG4gIFx0bGV0IHRhcmdldElEID0gKHJlc3BvbmQpID8gcmVzcG9uZC5nZXRBdHRyaWJ1dGUoJ2hyZWYnKSA6IHRoaXMuZ2V0QXR0cmlidXRlKCdocmVmJylcblxuICBcdGNvbnN0IHRhcmdldEFuY2hvciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodGFyZ2V0SUQpXG5cbiAgICBpZiAoIXRhcmdldEFuY2hvcikgcmV0dXJuXG5cbiAgXHRjb25zdCBvcmlnaW5hbFRvcCA9IGRpc3RhbmNlVG9Ub3AodGFyZ2V0QW5jaG9yKVxuXG4gIFx0d2luZG93LnNjcm9sbEJ5KHsgdG9wOiBvcmlnaW5hbFRvcCwgbGVmdDogMCwgYmVoYXZpb3I6ICdzbW9vdGgnIH0pXG5cbiAgXHRjb25zdCBjaGVja0lmRG9uZSA9IHNldEludGVydmFsKGZ1bmN0aW9uKCkge1xuICBcdFx0Y29uc3QgYXRCb3R0b20gPSB3aW5kb3cuaW5uZXJIZWlnaHQgKyB3aW5kb3cucGFnZVlPZmZzZXQgPj0gZG9jdW1lbnQuYm9keS5vZmZzZXRIZWlnaHQgLSAyXG4gIFx0XHRpZiAoZGlzdGFuY2VUb1RvcCh0YXJnZXRBbmNob3IpID09PSAwIHx8IGF0Qm90dG9tKSB7XG4gIFx0XHRcdHRhcmdldEFuY2hvci50YWJJbmRleCA9ICctMSdcbiAgXHRcdFx0dGFyZ2V0QW5jaG9yLmZvY3VzKClcbiAgXHRcdFx0d2luZG93Lmhpc3RvcnkucHVzaFN0YXRlKCcnLCAnJywgdGFyZ2V0SUQpXG4gIFx0XHRcdGNsZWFySW50ZXJ2YWwoY2hlY2tJZkRvbmUpXG4gIFx0XHR9XG4gIFx0fSwgMTAwKVxuXG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1lbnUnKS5jbGFzc0xpc3QucmVtb3ZlKCdtZW51X29wZW4nKVxuICB9XG5cbiAgdmFyIHRyYW5zbGF0ZSA9IGZ1bmN0aW9uKGVsZW0sIHgsIHksIHJvdGF0ZSkge1xuXHRcdCQoZWxlbSkuY3NzKHtcblx0XHRcdCd0cmFuc2Zvcm0nOiAndHJhbnNsYXRlM2QoJyArIHggKyAncHgsJyArIHkgKyAncHgsIDBweCkgcm90YXRlKCcrIC1yb3RhdGUgKydkZWcpJyxcblx0XHRcdCctd2Via2l0LWJhY2tmYWNlLXZpc2liaWxpdHknOiAnaGlkZGVuJyxcblx0XHRcdCctd2Via2l0LXBlcnNwZWN0aXZlJzogMTAwMCxcblx0XHRcdCd3aWxsLWNoYW5nZSc6ICd0cmFuc2Zvcm0nXG5cdFx0fSk7XG5cdH07XG5cbiAgLy8gcGFyYWxsYXhcbiAgJCh3aW5kb3cpLm9uKCdzY3JvbGwnLCBmdW5jdGlvbigpIHtcbiAgICB2YXIgdG9wID0gJChkb2N1bWVudCkuc2Nyb2xsVG9wKCk7XG5cbiAgICB0cmFuc2xhdGUoXCIjZGVjb3ItZWwxXCIsIDAsIHRvcC8xMCwgdG9wLzMwKTtcbiAgICB0cmFuc2xhdGUoXCIjZGVjb3ItZWwyXCIsIDAsIC10b3AvMTAsIDApO1xuICAgIHRyYW5zbGF0ZShcIiNkZWNvci1lbDNcIiwgMCwgLXRvcC80MCwgdG9wLzMwKTtcbiAgICB0cmFuc2xhdGUoXCIjZGVjb3ItZWw0XCIsIDAsIHRvcC8xMDAsIDApO1xuICAgIHRyYW5zbGF0ZShcIiNkZWNvci1lbDVcIiwgMCwgLXRvcC8yMCwgLXRvcC8xMCk7XG4gICAgdHJhbnNsYXRlKFwiI2RlY29yLWVsNlwiLCAwLCAwLCAtdG9wLzIwKTtcbiAgICB0cmFuc2xhdGUoXCIjZGVjb3ItZWw3XCIsIDAsIHRvcC82MCwgMCk7XG4gICAgdHJhbnNsYXRlKFwiI2RlY29yLWVsOFwiLCAwLCAwLCAtdG9wLzIwKTtcbiAgICB0cmFuc2xhdGUoXCIjZGVjb3ItZWw5XCIsIC10b3AvNDAsIC10b3AvNDAsIDApO1xuICAgIHRyYW5zbGF0ZShcIiNkZWNvci1lbDEwXCIsIDAsIC10b3AvMTAwLCAtdG9wLzEwKTtcblxuXHR9KVxuXG4gIGNvbnN0IHNsaWRlck9wdGlvbnMgPSB7XG4gICAgJ3ByaXplcyc6IHtcbiAgICAgIGNlbGxBbGlnbjogJ2NlbnRlcicsXG4gICAgICBwcmV2TmV4dEJ1dHRvbnM6IGZhbHNlLFxuICAgICAgZ3JvdXBDZWxsczogKCQod2luZG93KS53aWR0aCgpIDw9IDc2OCkgPyAxIDogMixcbiAgICAgIHdyYXBBcm91bmQ6IHRydWUsXG4gICAgICBjb250YWluOiB0cnVlXG4gICAgfSxcbiAgICAncHJvZHVjdGlvbic6IHtcbiAgICAgIGNlbGxBbGlnbjogJ2NlbnRlcicsXG4gICAgICBwcmV2TmV4dEJ1dHRvbnM6IGZhbHNlLFxuICAgICAgZ3JvdXBDZWxsczogKCQod2luZG93KS53aWR0aCgpIDw9IDEwMDApID8gKCgkKHdpbmRvdykud2lkdGgoKSA8PSA3NjgpID8gMSA6IDIpIDogNCxcbiAgICAgIHdyYXBBcm91bmQ6IHRydWUsXG4gICAgICBjb250YWluOiB0cnVlXG4gICAgfVxuICB9XG5cbiAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnW2RhdGEtc2xpZGVyXScpLmZvckVhY2goKHNsaWRlciwgaSkgPT4ge1xuICAgIGNvbnN0IHNsaWRlcyA9IHNsaWRlci5xdWVyeVNlbGVjdG9yKCdbZGF0YS1zbGlkZXItc2xpZGVzXScpLFxuICAgICAgICAgIHNsaWRlc0NvdW50ID0gc2xpZGVzLmNoaWxkcmVuLmxlbmd0aCxcbiAgICAgICAgICBzbGlkZXJEYXRhID0gc2xpZGVyLmRhdGFzZXQuc2xpZGVyLFxuICAgICAgICAgIG9wdGlvbnMgPSBzbGlkZXJPcHRpb25zW3NsaWRlckRhdGFdLFxuICAgICAgICAgIHNsaWRlcldpZHRoID0gc2xpZGVyLm9mZnNldFdpZHRoLFxuICAgICAgICAgIHNsaWRlV2lkdGggPSBzbGlkZXMuY2hpbGRyZW5bMF0ub2Zmc2V0V2lkdGgsXG4gICAgICAgICAgc2xpZGVzQ2FwYWNpdHkgPSBNYXRoLnJvdW5kKHNsaWRlcldpZHRoL3NsaWRlV2lkdGgpLFxuICAgICAgICAgIGNvbnRyb2xzID0gc2xpZGVyLnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLXNsaWRlci1jb250cm9sc10nKSxcbiAgICAgICAgICBjb250cm9sc0VuZEluZGV4ID0gc2xpZGVzQ291bnQgLSBzbGlkZXNDYXBhY2l0eSxcbiAgICAgICAgICBhZGFwdGl2ZSA9IE51bWJlcihzbGlkZXIuZGF0YXNldC5zbGlkZXJBZGFwdGl2ZSksXG4gICAgICAgICAgd2luZG93V2lkdGggPSB3aW5kb3cuaW5uZXJXaWR0aFxuXG4gICAgbGV0IGNvbnRyb2xzUHJldiwgY29udHJvbHNOZXh0XG5cbiAgICBpZiAoY29udHJvbHMpIHtcbiAgICAgIGNvbnRyb2xzUHJldiA9IGNvbnRyb2xzLnF1ZXJ5U2VsZWN0b3IoJ1tkYXRhLXNsaWRlci1jb250cm9scy1wcmV2XScpLFxuICAgICAgY29udHJvbHNOZXh0ID0gY29udHJvbHMucXVlcnlTZWxlY3RvcignW2RhdGEtc2xpZGVyLWNvbnRyb2xzLW5leHRdJylcbiAgICB9XG5cbiAgICBpZiAoc2xpZGVzQ291bnQgPiBzbGlkZXNDYXBhY2l0eSkge1xuICAgICAgc2xpZGVyLmNsYXNzTGlzdC5hZGQoJ3NsaWRlcl9pbml0aWFsJylcbiAgICAgIGNvbnN0IGZsa3R5ID0gbmV3IEZsaWNraXR5KHNsaWRlcywgc2xpZGVyT3B0aW9uc1tzbGlkZXIuZGF0YXNldC5zbGlkZXJdKTtcblxuICAgICAgaWYgKGNvbnRyb2xzKSB7XG4gICAgICAgIGNvbnRyb2xzUHJldlxuICAgICAgICAgIC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7XG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KClcbiAgICAgICAgICAgIGZsa3R5LnByZXZpb3VzKClcbiAgICAgICAgICB9KVxuXG4gICAgICAgIGNvbnRyb2xzTmV4dFxuICAgICAgICAgIC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7XG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KClcbiAgICAgICAgICAgIGZsa3R5Lm5leHQoKVxuICAgICAgICAgIH0pXG5cbiAgICAgICAgaWYgKCFvcHRpb25zLndyYXBBcm91bmQpIHtcbiAgICAgICAgICBpZiAoZmxrdHkuc2VsZWN0ZWRJbmRleCA9PT0gMCkge1xuICAgICAgICAgICAgY29udHJvbHNQcmV2LmRpc2FibGVkID0gdHJ1ZVxuICAgICAgICAgIH0gZWxzZSBpZiAoZmxrdHkuc2VsZWN0ZWRJbmRleCA9PT0gY29udHJvbHNFbmRJbmRleCkge1xuICAgICAgICAgICAgY29udHJvbHNOZXh0LmRpc2FibGVkID0gdHJ1ZVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfSlcblxuICAkKCcucXVlc3Rpb25fX2hlYWRlcicpLm9uKCdjbGljaycsIGZ1bmN0aW9uKGUpIHtcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICAkKHRoaXMpLm5leHQoKS5zbGlkZVRvZ2dsZSgpO1xuICAgICQodGhpcykucGFyZW50KCkudG9nZ2xlQ2xhc3MoJ29wZW4nKTtcbiAgfSlcblxuICAkKCcubmF2aWdhdG9yX19tZW51Jykub24oJ2NsaWNrJywgZnVuY3Rpb24oZSkge1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAkKCcubWVudScpLnRvZ2dsZSgpO1xuICB9KVxuXG4gICQoJy5tZW51X19jbG9zZScpLm9uKCdjbGljaycsIGZ1bmN0aW9uKGUpIHtcbiAgICAkKCcubWVudScpLmhpZGUoKTtcbiAgfSlcblxuICAkKCcubWVudV9fbGluaycpLm9uKCdjbGljaycsIGZ1bmN0aW9uKCkge1xuICAgICQoJy5tZW51X19jbG9zZScpLmNsaWNrKClcbiAgfSlcblxuICAvLyBtb2RhbHNcblxuICAkKCdbZGF0YS1tb2RhbF0nKS5pemlNb2RhbCgpXG5cbiAgJCgnW2RhdGEtbW9kYWwtb3Blbl0nKS5vbignY2xpY2snLCBmdW5jdGlvbihlKSB7XG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpXG5cblxuICAgIGNvbnN0IGRhdGEgPSAkKHRoaXMpLmRhdGEoJ21vZGFsLW9wZW4nKVxuICAgICQoYFtkYXRhLW1vZGFsPVwiJHtkYXRhfVwiXWApLml6aU1vZGFsKCdvcGVuJylcbiAgfSlcblxufSkod2luZG93KTtcbiJdfQ==
